(()=>{"use strict";!function(){const t=function(t){const e=t.dataset.dataSource||WSUWP_DATA.siteUrl||"",s="true"===t.dataset.showSessionFilter,a="true"===t.dataset.showCampusFilter,n="true"===t.dataset.showCareerPathFilter,o=t.dataset.componentId||"",l=t.dataset.errorMessage||"";let r,c,i,u,d=new AbortController;async function f(s){u.innerHTML="",t.classList.add("is-loading");const a=c.find((e=>e.type===t.dataset.defaultType&&e.session===s.session.value&&e.campus===s.campus.value&&e.careerPath===s.careerPath.value));u.innerHTML=await async function(t){d?.abort(),d=new AbortController;let s="";if(t){const a=t.tableId,n=await fetch(e+"/wp-json/wsu-cost-tables/v1/render-table?tableId="+a.replace("table-",""),{signal:d.signal});n.ok&&(s=await n.json())}return""===s?`<p class="wsu-cost-tables__error">${l}</p>`:s}(a),t.classList.remove("is-loading")}function w(t="",e="",s=[],a=""){return`\n\t\t\t<div class="wsu-cost-tables__filter wsu-cost-tables__filter--${e}">\n\t\t\t\t<label\n\t\t\t\tclass="wsu-cost-tables__filter-label"\n\t\t\t\tfor="wsu-cost-table-filter-${e}-${o}"\n\t\t\t\t>${t}</label\n\t\t\t\t><select\n\t\t\t\tdata-property="${e}"\n\t\t\t\tclass="wsu-cost-tables__filter-select"\n\t\t\t\tid="wsu-cost-table-filter-${e}-${o}"\n\t\t\t\t>\n\t\t\t\t${s.map((t=>`<option value="${t.slug}" ${a===t.slug?'selected="selected"':""}>${t.name}</option>`))}\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t`}!async function(){r=await async function(){const t=await fetch(e+"/wp-json/wsu-cost-tables/v1/get-cost-table-settings");if(t.ok)return await t.json();throw new Error("Failed to get cost table setting.")}(),c=await async function(){const t=await fetch(e+"/wp-json/wsu-cost-tables/v1/get-table-taxonomies");if(t.ok){const e=await t.json();return s=e,Object.keys(s).map((t=>({tableId:t,...s[t]})))}var s;throw new Error("Failed to get taxonomy information for tables.")}(),({filterControls:i,tableContainer:u}=function(e){const o=`\n\t\t\t\t${s||a||n?`<div class="wsu-cost-tables__filters">\n\t\t\t\t\t\t\t\t${function(e){let o="";return o+=s?w("Year/Session","session",e.taxonomies.sessions,t.dataset.defaultSession):"",o+=a?w("Campus","campus",e.taxonomies.campuses,t.dataset.defaultCampus):"",o+=n?w("Career Path","career-path",e.taxonomies.careerPaths,t.dataset.defaultCareerPath):"",o}(e)}\n\t\t\t\t\t\t\t</div>`:""}\n\t\t\t\t<div class="wsu-cost-tables__loading"></div>\n\t\t\t\t<div class="wsu-cost-tables__table-container"></div>\n\t\t\t`;return t.innerHTML=o,{filterControls:{session:t.querySelector(".wsu-cost-tables__filter--session .wsu-cost-tables__filter-select"),campus:t.querySelector(".wsu-cost-tables__filter--campus .wsu-cost-tables__filter-select"),careerPath:t.querySelector(".wsu-cost-tables__filter--career-path .wsu-cost-tables__filter-select")},tableContainer:t.querySelector(".wsu-cost-tables__table-container")}}(r)),f(i),Object.values(i).forEach((function(t){t.addEventListener("change",(function(t){f(i)}))}))}()};document.querySelectorAll(".wsu-cost-tables").forEach((e=>{new t(e)}))}()})();